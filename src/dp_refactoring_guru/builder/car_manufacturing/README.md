Note: implementation này khác một chút với trên refactoring_guru